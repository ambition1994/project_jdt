!function(a){"function"==typeof define&&define.amd?define("bxchartsline",["bxcharts"],function(){a(window.jQuery)}):a(window.jQuery)}(function(a){a.widget("baosight.bxchartsline",a.baosight.bxcharts,{_create:function(){this._super(),console.log("bxchartsline widget create")},_init:function(){return this._super(),console.log("bxchartsline widget init"),this.combinateOption(),"local"==this.options.dataPattern?void this.queryFromLocal("line"):void this._query("line")},destroy:function(){console.log("bxchartsline widget destroy"),this._superApply(arguments)},options:{option:{tooltip:{show:!0,trigger:"axis"},toolbox:{show:!1},calculable:!0,legend:{data:[]},xAxis:[{type:"category"}],yAxis:[{type:"value"}],theme:"macarons",series:[]},seriesObj:{type:"line"},chartRelate:{}},_setOption:function(a,b){console.log("_setOption: key=%s  value=%s",a,b),this._superApply(arguments)},_setOptions:function(a){var b;for(b in a)this._setOption(b,a[b]);return this},_query:function(b){var c=this;c.options.chartType=b;var d={};for(key in c.options)d[key]=c.options[key];a.ajax({url:c.options.ajaxUrl,method:"POST",crossDomain:!0,async:c.options.async,data:{ajaxParam:JSON.stringify(d)},processData:!0,dataType:"json",success:function(a,d,e){if(-1==a.status)return c.options.option.series=[{}],c.options.chartType="line",void c.showChart();console.log("chartAjaxData: ",a);var f=[],g=[],h=deepCopy(c.options.option.xAxis[0]),i=[],j=deepCopy(c.options.option.yAxis[0]);"dataValue"==c.options.chartRelate.xdataItem?(j.data=a[c.options.chartRelate.ydataItem],i.push(j),g.push(h),f=a[c.options.chartRelate.xdataItem]):(h.data=a[c.options.chartRelate.xdataItem],g.push(h),i.push(j),f=a[c.options.chartRelate.ydataItem]);for(var k=[],l=0;l<f.length;l++){var m=f[l],n=deepCopy(c.options.seriesObj);n.data=convertNullToUndefinedForArray(m.data),n.name=m.series.name,n.type=b,k.push(n)}c.options.option.legend.data=a[c.options.chartRelate.legendItem],c.options.option.series=k,c.options.option.xAxis=g,c.options.option.yAxis=i,void 0!=c.options.preHandlerFunct&&null!=c.options.preHandlerFunct&&c.options.preHandlerFunct(c.options.option,a),c.showChartForLine()}})},query:function(){return"local"==this.options.dataPattern?void this.queryFromLocal("line"):void this._query("line")},showChartForLine:function(){var a=this,b=a.loadchartsDependcies();require(b,function(){var b=ec.init(a.element.get(0),a.options.option.theme);b.setOption(a.options.option,!0),"dynamic"==a.options.showPattern&&void 0!=a.options.refreshInterval&&null!=a.options.refreshInterval&&a.dynamicQuery(b),window.onresize=b.resize,null!=a.options.callBackFunct&&void 0!=a.options.callBackFunct&&a.options.callBackFunct()})},dynamicQuery:function(b){var c=this;setInterval(function(){for(var d={},e=c.options.condition.categoryLst,f=0;f<e.length;f++)"date"==e[f].type&&(d=e[f]);var g=d.currentTime;d.currentTime=g+c.options.refreshInterval;var h=d.value;d.value=DateUtil.dynamicTime(h,c.options.refreshInterval);var i={};i.condition=c.options.condition,i.chartRelate=c.options.chartRelate,i.dataPattern=c.options.dataPattern,a.ajax({url:c.options.ajaxUrl,method:"POST",crossDomain:!0,async:c.options.async,data:{ajaxParam:JSON.stringify(i)},processData:!0,dataType:"json",success:function(a,d,e){console.log("chartAjaxData: ",a);for(var f=a.dataValue,g=a[c.options.chartRelate.xdataItem],h=[],i=0;i<f.length;i++){var j=f[i],k=[i,convertNullToUndefined(j.data[j.data.length-1]),!1,!1];0==i&&k.push(g[g.length-1]),h.push(k)}b.addData(h),null!=c.options.callBackFunct&&void 0!=c.options.callBackFunct&&c.options.callBackFunct()}})},c.options.refreshInterval+100)}})});