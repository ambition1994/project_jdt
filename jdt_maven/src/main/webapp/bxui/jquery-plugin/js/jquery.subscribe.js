!function(a){var b={};a.fn.extend({subscribe:function(a,c,d){var e=b[a];e||(e=this._createEventName(a));var f=this;if(this.subscribers){this.subscribers[a]=c;for(var g in e)if(g._fn===c)return this}var h=function(){return c.apply(f,d||arguments)};return h._fn=c,this._appendHandler(e,h),this},unsubscribe:function(a,c){var d=b[a];return d?this._removeHandler(d,c):!1},publish:function(a,c,d){var e=b[a];if(e){var f=e,g=f.length;b[a]=[];for(var h=0;g>h;h++){var i=f.shift();if(b[a].push(i),i.apply({},c||[])===!1)return b[a]=b[a].concat(f),!1}return!0}},publishOnEvent:function(b,c,d){return this._createEventName(c),this.bind(b,d,function(b){a(this).publish(c,b.data,b)}),this},_createEventName:function(a){return b[a]||(b[a]=[]),b[a]},_appendHandler:function(a,b){for(var c=a.length,d=0;c>d;d++)if(a[d]._fn===b._fn)return!1;return a.push(b),!0},_removeHandler:function(a,b){var c=a.length;b||(a=[]);for(var d=0;c>d;d++){var e=a.shift();if(e._fn==b)return!0;a.push(e)}return!1}}),a.extend({subscribe:function(b,c,d){return a().subscribe(b,c,d)},unsubscribe:function(b,c){return a().unsubscribe(b,c)},publish:function(b,c,d){return a().publish(b,c,d)}})}(jQuery);